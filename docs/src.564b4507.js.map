{"version":3,"sources":["../src/CoAnMoPluginCliV1.ts","src/Actions/help.ts","src/Actions/hue.ts","src/Actions/random.ts","src/Actions/version.ts","src/Actions/actions.ts","src/index.ts"],"names":[],"mappings":"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","file":"src.564b4507.js","sourceRoot":"..","sourcesContent":["export interface ActionMetaI {\n  actions: ActionI[];\n  name: string;\n  version: string;\n}\n\nexport interface ActionI {\n  name: string;\n  summary: string;\n  fn: (args: string[], meta: ActionMetaI) => string;\n}\n\nexport class CoAnMoPluginCliV1 {\n  private $stdin: HTMLInputElement | null;\n  private $stdout: HTMLElement | null;\n  private actions: ActionI[] = [];\n\n  constructor(\n    private name: string,\n    private version: string,\n    stdinSelector: string,\n    stdoutSelector: string,\n    doc: HTMLDocument\n  ) {\n    this.$stdin = doc.querySelector(stdinSelector);\n    this.$stdout = doc.querySelector(stdoutSelector);\n    this.log(\"CoAnMoPluginCliV1()\");\n\n    if (this.$stdin)\n      this.$stdin.addEventListener(\"keydown\", (evt: KeyboardEvent) => {\n        if (this.$stdin && evt.key === \"Enter\") this.run(this.$stdin.value);\n      });\n  }\n\n  addActions(actions: ActionI[]) {\n    actions.forEach(action => this.actions.push(action));\n  }\n\n  focusOnInput() {\n    if (this.$stdin) this.$stdin.focus();\n  }\n\n  log(message: string) {\n    if (!this.$stdout) return;\n    this.$stdout.innerHTML += `\\n${message}`;\n    this.$stdout.scroll(0, 999999);\n  }\n\n  run(command: string) {\n    if (!this.$stdin) return;\n    const [actionName, ...args] = command.trim().split(/\\s+/);\n    const actionNameLc = actionName.toLowerCase(); // because, iPad keyboard\n    if (actionName === \"\") {\n      this.$stdin.value = \"\";\n      return this.log(\">\");\n    }\n    const action = this.actions.find(actn => actn.name === actionNameLc);\n    if (!action)\n      return this.log(`No such action '${actionNameLc}' - try 'help'`);\n    this.log(`> ${actionNameLc} ${args.join(' ')}`);\n    this.$stdin.value = \"\";\n    this.log(\n      action.fn(args, {\n        actions: this.actions,\n        name: this.name,\n        version: this.version\n      })\n    );\n  }\n}\n","import { ActionI, ActionMetaI } from \"coanmo-plugin-cli\";\n\nexport const help: ActionI = {\n  name: \"help\",\n  summary: \"Shows a help message\",\n  fn(args: string[], meta: ActionMetaI) {\n    const { actions, name, version } = meta;\n    const longest = actions.reduce(\n      (longest = 0, action: ActionI) => Math.max(longest, action.name.length),\n      0\n    );\n    if (args.length === 0)\n      return [\n        `${name} ${version} Actions:`,\n        ...actions.map(\n          (action: ActionI) =>\n            `${action.name.padEnd(longest + 2, \" \")}${action.summary}`\n        )\n      ].join(\"\\n\");\n    if (args.length !== 1)\n      return `'help' got ${args.length} args, expected 0 or 1 ${args.join()}`;\n    const actionNameLc = args[0].toLowerCase();\n    const action = actions.find(actn => actn.name === actionNameLc);\n    if (!action) return `No such action '${actionNameLc}'`;\n    return `${action.name}  ${action.summary}`;\n  }\n};\n","import { ActionI, ActionMetaI } from \"coanmo-plugin-cli\";\n\nexport enum Hue {\n  red = \"red\",\n  orange = \"orange\",\n  yellow = \"yellow\",\n  green = \"green\",\n  cyan = \"cyan\",\n  blue = \"blue\",\n  magenta = \"magenta\",\n  grey = \"grey\"\n}\n\nexport function stringToHue(string: string): Hue | void {\n  switch (string) {\n    case \"red\":\n      return Hue.red;\n    case \"orange\":\n      return Hue.orange;\n    case \"yellow\":\n      return Hue.yellow;\n    case \"green\":\n      return Hue.green;\n    case \"cyan\":\n      return Hue.cyan;\n    case \"blue\":\n      return Hue.blue;\n    case \"magenta\":\n      return Hue.magenta;\n    case \"grey\":\n      return Hue.grey;\n    default:\n      return undefined;\n  }\n}\n\nexport function getCurrentHue(doc: Document): Hue {\n  const hueClass = doc.body.className\n    .split(/\\s+/)\n    .find(className => className.slice(0, 4) === \"hue-\");\n  if (!hueClass) return Hue.blue; // `undefined` defaults to blue, if not found\n  const hue = stringToHue(hueClass.slice(4));\n  if (!hue) return Hue.blue; // 'hue-nope' defaults to blue\n  return hue;\n}\n\nexport const hue: ActionI = {\n  name: \"hue\",\n  summary: \"Gets/sets the color scheme\",\n  fn(args: string[], meta: ActionMetaI) {\n    const currentHue = getCurrentHue(document);\n    if (args.length === 0) return `${currentHue}`;\n    if (args.length !== 1)\n      return `'hue' got ${args.length} args, expected 0 or 1 ${args.join()}`;\n    const newHue = stringToHue(args[0]);\n    if (!newHue)\n      return `'hue' got unexpected argument '${args[0]}' — try 'green'`;\n    document.body.classList.remove(`hue-${currentHue}`);\n    document.body.classList.add(`hue-${args[0]}`);\n    return `Was ${currentHue}, now ${args[0]}`;\n  }\n};\n","import { ActionI } from \"coanmo-plugin-cli\";\n\nexport const random: ActionI = {\n  name: \"random\",\n  summary: \"Shows a random number\",\n  fn() {\n    return `${Math.random()}`.slice(2);\n  }\n};\n","import { ActionI, ActionMetaI } from \"coanmo-plugin-cli\";\n\nexport const version: ActionI = {\n  name: \"version\",\n  summary: \"Shows the CoAnMo’s version\",\n  fn(args: string[], meta: ActionMetaI) {\n    const { name, version } = meta;\n    return `${name} ${version}`;\n  }\n};\n","import { help } from \"./help\";\nimport { hue } from \"./hue\";\nimport { random } from \"./random\";\nimport { version } from \"./version\";\n\nexport const actions = [help, hue, random, version];\n","import './style';\nimport { CoAnMoPluginCliV1 } from \"coanmo-plugin-cli\";\nimport { actions } from \"./Actions/actions\";\n\nclass CoAnMoWhichImportsCLI {\n  private cli: CoAnMoPluginCliV1;\n\n  constructor(\n    private name: string,\n    private version: string,\n    selector: string,\n    doc: HTMLDocument\n  ) {\n    this.cli = new CoAnMoPluginCliV1(\n      name,\n      version,\n      `${selector} .stdin`,\n      `${selector} .stdout`,\n      doc\n    );\n\n    this.cli.addActions(actions);\n    this.cli.log(\"Ready\");\n  }\n\n  receiveMessage(event: MessageEvent) {\n    // @TODO add validation and security\n    if (typeof event.data === \"string\") this.cli.run(event.data);\n  }\n}\n\nconst coanmo = new CoAnMoWhichImportsCLI(\n  \"CoAnMo Which Imports CLI\",\n  \"1.0.7\",\n  \"#coanmo-which-imports-cli\",\n  document\n);\n\nwindow.addEventListener(\n  \"message\",\n  (event: MessageEvent) => coanmo.receiveMessage(event),\n  false\n);\n"]}